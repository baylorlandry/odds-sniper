import {americanToProb,percentDiff} from './utils/oddsMath.js';const THRESHOLD=1;let consensus={};chrome.storage.local.get(['consensus'],d=>consensus=d.consensus||{});chrome.storage.onChanged.addListener(c=>{if(c.consensus)consensus=c.consensus.newValue;});function scan(){const regex=/([+-]\d{3})/g;document.querySelectorAll('body *:not(script):not(style)').forEach(n=>{const t=n.textContent;if(!t)return;const m=t.match(regex);if(!m)return;const odds=parseInt(m[0]);const pPage=americanToProb(odds);const g=Object.values(consensus)[0];if(!g)return;const pMarket=americanToProb(odds>0?g.away_ml:g.home_ml);const diff=Math.abs(percentDiff(pPage,pMarket));if(diff*100>=THRESHOLD)n.classList.add('oddsniper-highlight');});}setInterval(scan,3000);